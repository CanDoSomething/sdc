{"version":3,"sources":["webpack:///static/js/11.f930dafb63a0d35caacf.js","webpack:///./src/chart/index.vue?4b64","webpack:///./src/chart/index.vue?3022","webpack:///./src/chart/index.vue?7d53","webpack:///./src/chart/chartSocket.js","webpack:///./src/chart/index.vue","webpack:///./src/chart/index.vue?0683"],"names":["webpackJsonp","LU1+","module","exports","__webpack_require__","push","i","version","sources","names","mappings","file","sourcesContent","sourceRoot","R/zc","content","locals","Yid5","__webpack_exports__","injectStyle","ssrContext","Object","defineProperty","value","request","promise","promise_default","n","stringify","stringify_default","helpers_extends","extends_default","vuex_esm","common","chartSocket","name","data","ws","otherImg","selfImg","nowStuCode","nowTeaCode","stuIsInGroup","teaIsInGroup","computed","mapState","userType","state","user","openid","mounted","this","getOpenid","watch","courseId","methods","_this","undefined","url","method","artId","$route","params","id","$store","then","res","code","teaOpenid","stuOpenid","type","Number","obj","stuHeadimgurl","teaHeadimgurl","initWebsocket","WebSocket","onopen","websocketonopen","onmessage","websocketonmessage","onerror","websocketonerror","onclose","websocketclose","checkIsIn","resData","JSON","parse","recSocketMsg","initWebSocket","websocketsend","req","send","e","console","log","groupname","opttype","username","teaJoinGroup","addusername","loading","getHis","sendSocketMsg","msg","_this2","errno","errorMsg","renderHis","list","errmsg","$nextTick","renderChart","_this3","sort","a","b","inserttime","map","item","tmp","time","Date","_this4","resolve","getInfo","sendMsgFn","_getImg","_this5","noData","selectortype_script_index_0_src_chart","components","mixins","noCourse","courseName","teaName","courseTime","chartList","sendMsg","doingList","count","isEnd","btnDisabled","infoObj","commit","getDoingList","getCourseCount","showEnd","startCount","checkEnd","setTimeout","clickSend","msgTime","toTimeString","split","role","text","document","querySelector","scrollTop","getTime","str","filter","teaCourse","courseStatus","subStatus","courseDate","courseStartTime","courseEndTime","length","teaBase","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","_e","_v","_s","_l","src","directives","rawName","expression","disabled","domProps","on","keyup","$event","_k","keyCode","key","input","target","composing","class","btn-disabled","click","stopPropagation","staticRenderFns","esExports","selectortype_template_index_0_src_chart","normalizeComponent","__vue_styles__","Component"],"mappings":"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","file":"static/js/11.f930dafb63a0d35caacf.js","sourcesContent":["webpackJsonp([11],{\n\n/***/ \"LU1+\":\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(\"FZ+f\")(true);\n// imports\n\n\n// module\nexports.push([module.i, \"\\n.green[data-v-de02643e] {\\n  color: #03b349;\\n}\\n.doing-course[data-v-de02643e] {\\n  padding-bottom: 50px;\\n  margin-bottom: 10px;\\n}\\n.course-info[data-v-de02643e] {\\n  line-height: 2;\\n  margin: 10px 0;\\n  background: #fff;\\n  padding: 10px 20px;\\n}\\n.chart-box[data-v-de02643e] {\\n  height: calc(100% - 140px);\\n  overflow: hidden;\\n  line-height: 2;\\n  margin: 10px 0 0 0;\\n  padding: 10px 0 0 0;\\n}\\n.chart-list-scroll[data-v-de02643e] {\\n  padding: 0 20px;\\n  height: 100%;\\n  overflow: auto;\\n}\\n.chart-empty[data-v-de02643e] {\\n  color: #aaa;\\n  padding: 80px 0;\\n  text-align: center;\\n}\\n.msg-item[data-v-de02643e] {\\n  position: relative;\\n  margin-bottom: 14px;\\n}\\n.msg-item .user-icon[data-v-de02643e] {\\n    position: absolute;\\n    width: 30px;\\n    height: 30px;\\n    border: 2px solid #03b349;\\n    border-radius: 40px;\\n}\\n.msg-item .msg-time[data-v-de02643e] {\\n    line-height: 1.3;\\n    color: #aaa;\\n}\\n.msg-item .msg-text[data-v-de02643e] {\\n    min-height: 26px;\\n    display: inline-block;\\n    background: #fff;\\n    border: 1px solid #03b349;\\n    border-radius: 5px;\\n    padding: 0 20px;\\n    max-width: 100%;\\n    word-break: break-all;\\n    text-align: left;\\n}\\n.msg-item.msg-self .user-icon[data-v-de02643e] {\\n    right: 0;\\n}\\n.msg-item.msg-self .msg-content[data-v-de02643e] {\\n    padding-right: 50px;\\n    text-align: right;\\n}\\n.msg-item.msg-other .user-icon[data-v-de02643e] {\\n    left: 0;\\n}\\n.msg-item.msg-other .msg-content[data-v-de02643e] {\\n    padding-left: 50px;\\n}\\n.send-msg[data-v-de02643e] {\\n  position: fixed;\\n  bottom: 0;\\n  width: 100%;\\n  line-height: 2;\\n  background: #fbf9fe;\\n  padding: 0 0 6px 0;\\n}\\n.send-msg .send-box[data-v-de02643e] {\\n    border: 1px solid #eaeaea;\\n    border-width: 1px 0;\\n    background: #fff;\\n    height: 40px;\\n    position: relative;\\n}\\n.send-msg input[data-v-de02643e] {\\n    height: 40px;\\n    width: calc(100% - 80px);\\n    font-size: 16px;\\n    padding: 0 70px 0 10px;\\n    outline: 0;\\n    border: 0;\\n}\\n.send-msg .send-btn[data-v-de02643e] {\\n    background: #03b349;\\n    position: absolute;\\n    top: 0;\\n    right: 10px;\\n    color: #fff;\\n    padding: 0px 10px;\\n    margin: 8px 0;\\n    border-radius: 5px;\\n}\\n.send-msg .send-btn.btn-disabled[data-v-de02643e] {\\n      background: #eee;\\n      color: #aaa;\\n}\\n\", \"\", {\"version\":3,\"sources\":[\"D:/DATA/Vue/sdc-vue/src/chart/index.vue\"],\"names\":[],\"mappings\":\";AACA;EACE,eAAe;CAChB;AACD;EACE,qBAAqB;EACrB,oBAAoB;CACrB;AACD;EACE,eAAe;EACf,eAAe;EACf,iBAAiB;EACjB,mBAAmB;CACpB;AACD;EACE,2BAA2B;EAC3B,iBAAiB;EACjB,eAAe;EACf,mBAAmB;EACnB,oBAAoB;CACrB;AACD;EACE,gBAAgB;EAChB,aAAa;EACb,eAAe;CAChB;AACD;EACE,YAAY;EACZ,gBAAgB;EAChB,mBAAmB;CACpB;AACD;EACE,mBAAmB;EACnB,oBAAoB;CACrB;AACD;IACI,mBAAmB;IACnB,YAAY;IACZ,aAAa;IACb,0BAA0B;IAC1B,oBAAoB;CACvB;AACD;IACI,iBAAiB;IACjB,YAAY;CACf;AACD;IACI,iBAAiB;IACjB,sBAAsB;IACtB,iBAAiB;IACjB,0BAA0B;IAC1B,mBAAmB;IACnB,gBAAgB;IAChB,gBAAgB;IAChB,sBAAsB;IACtB,iBAAiB;CACpB;AACD;IACI,SAAS;CACZ;AACD;IACI,oBAAoB;IACpB,kBAAkB;CACrB;AACD;IACI,QAAQ;CACX;AACD;IACI,mBAAmB;CACtB;AACD;EACE,gBAAgB;EAChB,UAAU;EACV,YAAY;EACZ,eAAe;EACf,oBAAoB;EACpB,mBAAmB;CACpB;AACD;IACI,0BAA0B;IAC1B,oBAAoB;IACpB,iBAAiB;IACjB,aAAa;IACb,mBAAmB;CACtB;AACD;IACI,aAAa;IACb,yBAAyB;IACzB,gBAAgB;IAChB,uBAAuB;IACvB,WAAW;IACX,UAAU;CACb;AACD;IACI,oBAAoB;IACpB,mBAAmB;IACnB,OAAO;IACP,YAAY;IACZ,YAAY;IACZ,kBAAkB;IAClB,cAAc;IACd,mBAAmB;CACtB;AACD;MACM,iBAAiB;MACjB,YAAY;CACjB\",\"file\":\"index.vue\",\"sourcesContent\":[\"\\n.green[data-v-de02643e] {\\n  color: #03b349;\\n}\\n.doing-course[data-v-de02643e] {\\n  padding-bottom: 50px;\\n  margin-bottom: 10px;\\n}\\n.course-info[data-v-de02643e] {\\n  line-height: 2;\\n  margin: 10px 0;\\n  background: #fff;\\n  padding: 10px 20px;\\n}\\n.chart-box[data-v-de02643e] {\\n  height: calc(100% - 140px);\\n  overflow: hidden;\\n  line-height: 2;\\n  margin: 10px 0 0 0;\\n  padding: 10px 0 0 0;\\n}\\n.chart-list-scroll[data-v-de02643e] {\\n  padding: 0 20px;\\n  height: 100%;\\n  overflow: auto;\\n}\\n.chart-empty[data-v-de02643e] {\\n  color: #aaa;\\n  padding: 80px 0;\\n  text-align: center;\\n}\\n.msg-item[data-v-de02643e] {\\n  position: relative;\\n  margin-bottom: 14px;\\n}\\n.msg-item .user-icon[data-v-de02643e] {\\n    position: absolute;\\n    width: 30px;\\n    height: 30px;\\n    border: 2px solid #03b349;\\n    border-radius: 40px;\\n}\\n.msg-item .msg-time[data-v-de02643e] {\\n    line-height: 1.3;\\n    color: #aaa;\\n}\\n.msg-item .msg-text[data-v-de02643e] {\\n    min-height: 26px;\\n    display: inline-block;\\n    background: #fff;\\n    border: 1px solid #03b349;\\n    border-radius: 5px;\\n    padding: 0 20px;\\n    max-width: 100%;\\n    word-break: break-all;\\n    text-align: left;\\n}\\n.msg-item.msg-self .user-icon[data-v-de02643e] {\\n    right: 0;\\n}\\n.msg-item.msg-self .msg-content[data-v-de02643e] {\\n    padding-right: 50px;\\n    text-align: right;\\n}\\n.msg-item.msg-other .user-icon[data-v-de02643e] {\\n    left: 0;\\n}\\n.msg-item.msg-other .msg-content[data-v-de02643e] {\\n    padding-left: 50px;\\n}\\n.send-msg[data-v-de02643e] {\\n  position: fixed;\\n  bottom: 0;\\n  width: 100%;\\n  line-height: 2;\\n  background: #fbf9fe;\\n  padding: 0 0 6px 0;\\n}\\n.send-msg .send-box[data-v-de02643e] {\\n    border: 1px solid #eaeaea;\\n    border-width: 1px 0;\\n    background: #fff;\\n    height: 40px;\\n    position: relative;\\n}\\n.send-msg input[data-v-de02643e] {\\n    height: 40px;\\n    width: calc(100% - 80px);\\n    font-size: 16px;\\n    padding: 0 70px 0 10px;\\n    outline: 0;\\n    border: 0;\\n}\\n.send-msg .send-btn[data-v-de02643e] {\\n    background: #03b349;\\n    position: absolute;\\n    top: 0;\\n    right: 10px;\\n    color: #fff;\\n    padding: 0px 10px;\\n    margin: 8px 0;\\n    border-radius: 5px;\\n}\\n.send-msg .send-btn.btn-disabled[data-v-de02643e] {\\n      background: #eee;\\n      color: #aaa;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n/***/ }),\n\n/***/ \"R/zc\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(\"LU1+\");\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(\"rjj0\")(\"f958979a\", content, true, {});\n\n/***/ }),\n\n/***/ \"Yid5\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// EXTERNAL MODULE: ./src/utils/request.js\nvar request = __webpack_require__(\"vLgD\");\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/core-js/promise.js\nvar promise = __webpack_require__(\"//Fk\");\nvar promise_default = /*#__PURE__*/__webpack_require__.n(promise);\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/core-js/json/stringify.js\nvar stringify = __webpack_require__(\"mvHQ\");\nvar stringify_default = /*#__PURE__*/__webpack_require__.n(stringify);\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/helpers/extends.js\nvar helpers_extends = __webpack_require__(\"Dd8w\");\nvar extends_default = /*#__PURE__*/__webpack_require__.n(helpers_extends);\n\n// EXTERNAL MODULE: ./node_modules/vuex/dist/vuex.esm.js\nvar vuex_esm = __webpack_require__(\"NYxO\");\n\n// EXTERNAL MODULE: ./src/utils/common.js\nvar common = __webpack_require__(\"X2Oc\");\n\n// CONCATENATED MODULE: ./src/chart/chartSocket.js\n\n\n\n\n\n\n/* harmony default export */ var chartSocket = ({\n  name: 'chartMixin',\n  data: function data() {\n    return {\n      ws: null,\n      otherImg: '',\n      selfImg: '',\n      nowStuCode: '',\n      nowTeaCode: '',\n      stuIsInGroup: false,\n      teaIsInGroup: false\n    };\n  },\n\n  computed: extends_default()({}, Object(vuex_esm[\"b\" /* mapState */])({\n    userType: function userType(state) {\n      return state.user.userType;\n    },\n    openid: function openid(state) {\n      return state.user.openid;\n    }\n    // selfImg: state => state.user.infoObj.teaHeadimgurl || state.user.infoObj.stuHeadimgurl\n    // courseId: state => state.course.courseId\n  })),\n  mounted: function mounted() {\n    this.getOpenid();\n    // this.initWebsocket()\n  },\n\n  watch: {\n    courseId: function courseId() {\n      this.getOpenid();\n      // this.initWebsocket()\n    }\n  },\n  methods: {\n    getOpenid: function getOpenid() {\n      var _this = this;\n\n      if (this.courseId === undefined || this.courseId === '') {\n        return;\n      }\n      Object(request[\"a\" /* default */])({\n        url: 'course/getOnClassUserOpenid?courseId=' + this.courseId,\n        method: 'get',\n        data: {\n          artId: this.$route.params.id,\n          openid: this.$store.state.user.openid\n        }\n      }).then(function (res) {\n        if (res.data.code === 0) {\n          _this.nowTeaCode = res.data.data.teaOpenid;\n          _this.nowStuCode = res.data.data.stuOpenid;\n\n          Object(request[\"a\" /* default */])({\n            url: 'user/queryUserInfo?openid=' + _this.nowTeaCode,\n            method: 'get'\n          }).then(function (res) {\n            // 获取自己头像\n            var type = _this.nowTeaCode === _this.openid ? 'self' : 'other';\n            if (Number(res.data.code) === 0) {\n              var obj = res.data.data;\n              _this[type + 'Img'] = obj.stuHeadimgurl || obj.teaHeadimgurl;\n            }\n            // 获取对方头像\n            Object(request[\"a\" /* default */])({\n              url: 'user/queryUserInfo?openid=' + _this.nowStuCode,\n              method: 'get'\n            }).then(function (res) {\n              var type = _this.nowTeaCode !== _this.openid ? 'self' : 'other';\n              // 获取之后才建立连接\n              _this.initWebsocket();\n              if (Number(res.data.code) === 0) {\n                var _obj = res.data.data;\n                _this[type + 'Img'] = _obj.stuHeadimgurl || _obj.teaHeadimgurl;\n              }\n            });\n          });\n        }\n      });\n    },\n    initWebsocket: function initWebsocket() {\n      if (this.ws === null && this.courseId !== '') {\n        var url = 'ws://47.93.225.12:8082/socketServer/' + this.openid;\n        this.ws = new WebSocket(url);\n\n        this.ws.onopen = this.websocketonopen;\n        this.ws.onmessage = this.websocketonmessage;\n        this.ws.onerror = this.websocketonerror;\n        this.ws.onclose = this.websocketclose;\n      }\n    },\n    websocketonopen: function websocketonopen() {\n      this.checkIsIn();\n    },\n    websocketonmessage: function websocketonmessage(res) {\n      var resData = JSON.parse(res.data);\n      this.recSocketMsg(resData);\n    },\n    websocketonerror: function websocketonerror() {\n      this.initWebSocket();\n    },\n    websocketsend: function websocketsend(req) {\n      this.ws.send(stringify_default()(req));\n    },\n    websocketclose: function websocketclose(e) {\n      console.log('断开连接', e);\n    },\n    checkIsIn: function checkIsIn() {\n      var req = {\n        groupname: this.courseId,\n        opttype: 'GetChatGroupUserList',\n        username: this.openid\n      };\n      this.websocketsend(req);\n    },\n\n    // 老师群组，如果老师不在就创建，并把学生加进来，在就获取历史记录\n    teaJoinGroup: function teaJoinGroup() {\n      var req = {\n        addusername: this.nowStuCode, // \"stuopenid\"\n        groupname: this.courseId, // \"courseid\"\n        opttype: 'CreateChatGroup',\n        username: this.openid // \"teaopenid\"\n      };\n      this.websocketsend(req);\n      this.loading = false;\n    },\n\n    // 学生群组，如果不在就提示退出等，在就获取历史记录\n    // 获取聊天记录\n    getHis: function getHis() {\n      var req = {\n        groupname: this.courseId, // \"courseid\"\n        opttype: 'GetChatGroupChatRecordList',\n        username: this.openid // \"stuopenid\"\n      };\n      this.websocketsend(req);\n    },\n\n    // socket发送消息\n    sendSocketMsg: function sendSocketMsg(msg) {\n      var req = {\n        content: msg,\n        groupname: this.courseId, // \"courseid\"\n        opttype: 'SendToChatGroup',\n        username: this.openid\n      };\n      this.websocketsend(req);\n    },\n\n    // socket接收消息\n    recSocketMsg: function recSocketMsg(data) {\n      var _this2 = this;\n\n      if (data.opttype === 'GetChatGroupUserList') {\n        // 判断是否在群里\n        if (data.errno !== 0) {\n          // 该用户不在群里\n          if (this.userType === 'teacher') {\n            this.teaJoinGroup();\n          } else {\n            Object(common[\"b\" /* errorMsg */])(this, '请退出,等待老师开课');\n          }\n        } else {\n          // 在群里，获取历史\n          this.loading = false;\n          this.getHis();\n        }\n      } else if (data.opttype === 'GetChatGroupChatRecordList') {\n        this.loading = false;\n        // 获取历史记录\n        if (data.errno === 0) {\n          this.renderHis(data.list);\n        } else {\n          Object(common[\"b\" /* errorMsg */])(this, data.errmsg);\n        }\n        this.$nextTick(function () {\n          _this2.loading = false;\n        });\n      } else if (data.opttype === 'SendToChatGroup') {\n        // 渲染聊天消息\n        // if (data.errno === 0) {\n        this.renderChart(data);\n        // } else {\n        //   errorMsg(this, data.errmsg)\n        // }\n      }\n    },\n    renderHis: function renderHis(list) {\n      var _this3 = this;\n\n      console.log('list', list);\n      list = list.sort(function (a, b) {\n        return Number(a.inserttime) - Number(b.inserttime);\n      });\n      list.map(function (item) {\n        var tmp = JSON.parse(item.content);\n        tmp.time = new Date(item.inserttime);\n        _this3.renderChart(tmp);\n      });\n    },\n    renderChart: function renderChart(data) {\n      var _this4 = this;\n\n      var type = data.username === this.openid ? 'self' : 'other';\n      console.log('re', this[type + 'Img']);\n      if (this[type + 'Img'] === '') {\n        new promise_default.a(function (resolve) {\n          _this4.getInfo(data.username, type, resolve);\n        }).then(function () {\n          _this4.sendMsgFn(type, data.content, data.time);\n        });\n      } else {\n        this.sendMsgFn(type, data.content, data.time);\n      }\n    },\n    getInfo: function getInfo(openid, type, resolve) {\n      if (type === 'self' && this['selfImg'] === '') {\n        this._getImg(openid, 'self', resolve);\n      }\n      if (type === 'other' && this['otherImg'] === '') {\n        this._getImg(openid, 'other', resolve);\n      }\n    },\n    _getImg: function _getImg(openid, type, resolve) {\n      var _this5 = this;\n\n      Object(request[\"a\" /* default */])({\n        url: 'user/queryUserInfo?openid=' + openid,\n        method: 'get'\n      }).then(function (res) {\n        resolve();\n        if (Number(res.data.code) === 0) {\n          var obj = res.data.data;\n          _this5[type + 'Img'] = obj.stuHeadimgurl || obj.teaHeadimgurl;\n        }\n      }, 20);\n    }\n  }\n});\n// EXTERNAL MODULE: ./src/components/noData.vue + 3 modules\nvar noData = __webpack_require__(\"8pLc\");\n\n// EXTERNAL MODULE: ./src/components/loading.vue + 3 modules\nvar loading = __webpack_require__(\"KgXo\");\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vux-loader/src/script-loader.js!./node_modules/vux-loader/src/script-loader.js!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./src/chart/index.vue\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\n\n\n/* harmony default export */ var chart = ({\n  name: 'chart',\n  components: { noData: noData[\"a\" /* default */], loading: loading[\"a\" /* default */] },\n  mixins: [chartSocket],\n  data: function data() {\n    return {\n      loading: true,\n      noCourse: false,\n      courseName: '',\n      teaName: '',\n      courseTime: '',\n      chartList: [],\n      sendMsg: '',\n      courseId: '',\n      doingList: [],\n      count: 0,\n      isEnd: false\n    };\n  },\n\n  computed: {\n    btnDisabled: function btnDisabled() {\n      return this.sendMsg === '';\n    },\n    teaOpenid: function teaOpenid() {\n      return this.$store.state.user.infoObj.teaOpenid || '';\n    },\n    stuOpenid: function stuOpenid() {\n      return this.$store.state.user.infoObj.stuOpenid || '';\n    },\n    userType: function userType() {\n      return this.$store.state.user.userType;\n    }\n  },\n  mounted: function mounted() {\n    this.$store.commit('SET_RETURN_TEXT', '在线交流');\n    this.$store.commit('SET_RETURN_URL', '/my');\n    this.getDoingList();\n  },\n\n  watch: {\n    userType: function userType() {\n      this.getDoingList();\n    }\n  },\n  methods: {\n    getCourseCount: function getCourseCount() {\n      var _this = this;\n\n      Object(request[\"a\" /* default */])({\n        url: 'course/getCountDown?courseId=' + this.courseId,\n        method: 'get'\n      }).then(function (res) {\n        if (res.data.code === 0) {\n          if (res.data.data === 'end') {\n            _this.showEnd();\n          } else {\n            _this.count = Number(res.data.data);\n            _this.startCount();\n          }\n        }\n      });\n    },\n    checkEnd: function checkEnd() {\n      var _this2 = this;\n\n      Object(request[\"a\" /* default */])({\n        url: 'course/onCourseEnd?courseId=' + this.courseId,\n        method: 'get'\n      }).then(function (res) {\n        if (res.data.code === 0) {\n          res.data.data = true;\n          _this2.isEnd = res.data.data;\n          if (!res.data.data) {\n            _this2.startCount();\n          } else {\n            _this2.showEnd();\n          }\n        }\n      });\n    },\n    startCount: function startCount() {\n      var _this3 = this;\n\n      setTimeout(function () {\n        _this3.checkEnd();\n      }, this.count * 1000);\n    },\n    showEnd: function showEnd() {\n      this.isEnd = true;\n      Object(common[\"c\" /* msg */])(this, '课程已结束');\n    },\n    clickSend: function clickSend() {\n      if (this.isEnd) {\n        return;\n      }\n      this.sendSocketMsg(this.sendMsg);\n      this.sendMsgFn('self', this.sendMsg);\n    },\n    sendMsgFn: function sendMsgFn(type, msg, time) {\n      // console.log('dd', type, msg)\n      if (msg === '') {\n        return;\n      }\n      var msgTime = time || new Date();\n      msgTime = msgTime.toTimeString().split(' ')[0];\n      this.chartList.push({\n        time: msgTime,\n        role: type,\n        text: msg\n      });\n      this.$nextTick(function () {\n        document.querySelector('.chart-list-scroll').scrollTop = 999999;\n      });\n      if (type === 'self') {\n        this.sendMsg = '';\n      }\n    },\n    getTime: function getTime(str) {\n      var hour = str.split(' ')[1].split(':')[0];\n      var min = str.split(' ')[1].split(':')[1];\n      return hour + ':' + min;\n    },\n    getDoingList: function getDoingList() {\n      var _this4 = this;\n\n      this.loading = true;\n      var url = '';\n      if (this.userType === 'teacher') {\n        url = 'tea/findTeaHistoryCourse';\n        url += '?teaOpenid=' + this.teaOpenid + '&page=1&pageSize=1000';\n      } else if (this.userType === 'student') {\n        url = 'stu/lookHistory';\n        url += '?stuOpenid=' + this.stuOpenid + '&page=1&pageSize=1000';\n      }\n      Object(request[\"a\" /* default */])({\n        url: url,\n        method: 'get'\n      }).then(function (res) {\n        _this4.loading = false;\n\n        if (res.data.code === 0 && res.data.data !== undefined) {\n          _this4.doingList = res.data.data.filter(function (item) {\n            if (_this4.userType === 'teacher') {\n              return item.teaCourse.courseStatus === 302;\n            } else {\n              return item.teaCourse.courseStatus === 302 && item.subStatus === 401;\n            }\n          }).map(function (item) {\n            item.teaCourse.courseTime = item.teaCourse.courseDate.split(' ')[0] + ' ' + _this4.getTime(item.teaCourse.courseStartTime) + ' - ' + _this4.getTime(item.teaCourse.courseEndTime);\n            return item;\n          });\n          if (_this4.doingList.length === 0) {\n            _this4.noCourse = true;\n            Object(common[\"b\" /* errorMsg */])(_this4, '请退出等待开课');\n          } else {\n            _this4.courseId = _this4.doingList[0].teaCourse.courseId;\n            _this4.courseName = _this4.doingList[0].teaCourse.courseName;\n            _this4.courseTime = _this4.doingList[0].teaCourse.courseTime;\n            if (_this4.userType === 'student') {\n              _this4.teaName = _this4.doingList[0].teaName;\n            } else {\n              _this4.teaName = _this4.doingList[0].teaBase.teaName;\n            }\n            _this4.noCourse = false;\n            _this4.getCourseCount();\n          }\n        } else {\n          _this4.noCourse = true;\n          Object(common[\"b\" /* errorMsg */])(_this4, '请退出等待开课');\n        }\n      });\n    }\n  }\n});\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vux-loader/src/script-loader.js!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./src/chart/index.vue\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\n\n\n/* harmony default export */ var selectortype_script_index_0_src_chart = ({\n  name: 'chart',\n  components: { noData: noData[\"a\" /* default */], loading: loading[\"a\" /* default */] },\n  mixins: [chartSocket],\n  data: function data() {\n    return {\n      loading: true,\n      noCourse: false,\n      courseName: '',\n      teaName: '',\n      courseTime: '',\n      chartList: [],\n      sendMsg: '',\n      courseId: '',\n      doingList: [],\n      count: 0,\n      isEnd: false\n    };\n  },\n\n  computed: {\n    btnDisabled: function btnDisabled() {\n      return this.sendMsg === '';\n    },\n    teaOpenid: function teaOpenid() {\n      return this.$store.state.user.infoObj.teaOpenid || '';\n    },\n    stuOpenid: function stuOpenid() {\n      return this.$store.state.user.infoObj.stuOpenid || '';\n    },\n    userType: function userType() {\n      return this.$store.state.user.userType;\n    }\n  },\n  mounted: function mounted() {\n    this.$store.commit('SET_RETURN_TEXT', '在线交流');\n    this.$store.commit('SET_RETURN_URL', '/my');\n    this.getDoingList();\n  },\n\n  watch: {\n    userType: function userType() {\n      this.getDoingList();\n    }\n  },\n  methods: {\n    getCourseCount: function getCourseCount() {\n      var _this = this;\n\n      Object(request[\"a\" /* default */])({\n        url: 'course/getCountDown?courseId=' + this.courseId,\n        method: 'get'\n      }).then(function (res) {\n        if (res.data.code === 0) {\n          if (res.data.data === 'end') {\n            _this.showEnd();\n          } else {\n            _this.count = Number(res.data.data);\n            _this.startCount();\n          }\n        }\n      });\n    },\n    checkEnd: function checkEnd() {\n      var _this2 = this;\n\n      Object(request[\"a\" /* default */])({\n        url: 'course/onCourseEnd?courseId=' + this.courseId,\n        method: 'get'\n      }).then(function (res) {\n        if (res.data.code === 0) {\n          res.data.data = true;\n          _this2.isEnd = res.data.data;\n          if (!res.data.data) {\n            _this2.startCount();\n          } else {\n            _this2.showEnd();\n          }\n        }\n      });\n    },\n    startCount: function startCount() {\n      var _this3 = this;\n\n      setTimeout(function () {\n        _this3.checkEnd();\n      }, this.count * 1000);\n    },\n    showEnd: function showEnd() {\n      this.isEnd = true;\n      Object(common[\"c\" /* msg */])(this, '课程已结束');\n    },\n    clickSend: function clickSend() {\n      if (this.isEnd) {\n        return;\n      }\n      this.sendSocketMsg(this.sendMsg);\n      this.sendMsgFn('self', this.sendMsg);\n    },\n    sendMsgFn: function sendMsgFn(type, msg, time) {\n      // console.log('dd', type, msg)\n      if (msg === '') {\n        return;\n      }\n      var msgTime = time || new Date();\n      msgTime = msgTime.toTimeString().split(' ')[0];\n      this.chartList.push({\n        time: msgTime,\n        role: type,\n        text: msg\n      });\n      this.$nextTick(function () {\n        document.querySelector('.chart-list-scroll').scrollTop = 999999;\n      });\n      if (type === 'self') {\n        this.sendMsg = '';\n      }\n    },\n    getTime: function getTime(str) {\n      var hour = str.split(' ')[1].split(':')[0];\n      var min = str.split(' ')[1].split(':')[1];\n      return hour + ':' + min;\n    },\n    getDoingList: function getDoingList() {\n      var _this4 = this;\n\n      this.loading = true;\n      var url = '';\n      if (this.userType === 'teacher') {\n        url = 'tea/findTeaHistoryCourse';\n        url += '?teaOpenid=' + this.teaOpenid + '&page=1&pageSize=1000';\n      } else if (this.userType === 'student') {\n        url = 'stu/lookHistory';\n        url += '?stuOpenid=' + this.stuOpenid + '&page=1&pageSize=1000';\n      }\n      Object(request[\"a\" /* default */])({\n        url: url,\n        method: 'get'\n      }).then(function (res) {\n        _this4.loading = false;\n\n        if (res.data.code === 0 && res.data.data !== undefined) {\n          _this4.doingList = res.data.data.filter(function (item) {\n            if (_this4.userType === 'teacher') {\n              return item.teaCourse.courseStatus === 302;\n            } else {\n              return item.teaCourse.courseStatus === 302 && item.subStatus === 401;\n            }\n          }).map(function (item) {\n            item.teaCourse.courseTime = item.teaCourse.courseDate.split(' ')[0] + ' ' + _this4.getTime(item.teaCourse.courseStartTime) + ' - ' + _this4.getTime(item.teaCourse.courseEndTime);\n            return item;\n          });\n          if (_this4.doingList.length === 0) {\n            _this4.noCourse = true;\n            Object(common[\"b\" /* errorMsg */])(_this4, '请退出等待开课');\n          } else {\n            _this4.courseId = _this4.doingList[0].teaCourse.courseId;\n            _this4.courseName = _this4.doingList[0].teaCourse.courseName;\n            _this4.courseTime = _this4.doingList[0].teaCourse.courseTime;\n            if (_this4.userType === 'student') {\n              _this4.teaName = _this4.doingList[0].teaName;\n            } else {\n              _this4.teaName = _this4.doingList[0].teaBase.teaName;\n            }\n            _this4.noCourse = false;\n            _this4.getCourseCount();\n          }\n        } else {\n          _this4.noCourse = true;\n          Object(common[\"b\" /* errorMsg */])(_this4, '请退出等待开课');\n        }\n      });\n    }\n  }\n});\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-de02643e\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vux-loader/src/before-template-compiler-loader.js!./node_modules/vux-loader/src/template-loader.js!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/chart/index.vue\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"doing-course\"},[(!_vm.loading && _vm.noCourse)?_c('div',{staticClass:\"no-course\"},[_c('no-data',{attrs:{\"text\":'当前没有正在上的课'}})],1):_vm._e(),_vm._v(\" \"),(!_vm.loading && !_vm.noCourse)?_c('div',{staticClass:\"course-info\"},[_c('div',{staticClass:\"course-name\"},[_c('label',[_vm._v(\"课程名称：\")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.courseName))])]),_vm._v(\" \"),_c('div',{staticClass:\"course-time\"},[_c('label',[_vm._v(\"课程时间：\")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.courseTime))])]),_vm._v(\" \"),_c('div',{staticClass:\"course-time\"},[_c('label',[_vm._v(\"老师姓名：\")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.teaName))])])]):_vm._e(),_vm._v(\" \"),(!_vm.loading && !_vm.noCourse)?_c('div',{staticClass:\"chart-box\"},[_c('div',{staticClass:\"chart-list-scroll\"},[_vm._l((_vm.chartList),function(item){return (_vm.chartList.length !== 0)?_c('div',{staticClass:\"chart-list\"},[(item.role === 'self')?_c('div',{staticClass:\"msg-self msg-item\"},[_c('img',{staticClass:\"user-icon\",attrs:{\"src\":_vm.selfImg}}),_vm._v(\" \"),_c('div',{staticClass:\"msg-content\"},[_c('div',{staticClass:\"msg-text\"},[_vm._v(_vm._s(item.text))]),_vm._v(\" \"),_c('div',{staticClass:\"msg-time\"},[_vm._v(_vm._s(item.time))])])]):_vm._e(),_vm._v(\" \"),(item.role === 'other')?_c('div',{staticClass:\"msg-other msg-item\"},[_c('img',{staticClass:\"user-icon\",attrs:{\"src\":_vm.otherImg}}),_vm._v(\" \"),_c('div',{staticClass:\"msg-content\"},[_c('div',{staticClass:\"msg-text\"},[_vm._v(_vm._s(item.text))]),_vm._v(\" \"),_c('div',{staticClass:\"msg-time\"},[_vm._v(_vm._s(item.time))])])]):_vm._e()]):_vm._e()}),_vm._v(\" \"),(_vm.chartList.length === 0)?_c('div',{staticClass:\"chart-list chart-empty\"},[_vm._v(\"\\n        暂无聊天记录\\n      \")]):_vm._e()],2)]):_vm._e(),_vm._v(\" \"),(!_vm.loading && !_vm.noCourse)?_c('div',{staticClass:\"send-msg\"},[_c('div',{staticClass:\"send-box\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.sendMsg),expression:\"sendMsg\"}],attrs:{\"type\":\"text\",\"disabled\":_vm.isEnd},domProps:{\"value\":(_vm.sendMsg)},on:{\"keyup\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.clickSend($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.sendMsg=$event.target.value}}}),_vm._v(\" \"),_c('div',{staticClass:\"send-btn\",class:{'btn-disabled': _vm.isEnd || _vm.btnDisabled},on:{\"click\":function($event){$event.stopPropagation();return _vm.clickSend($event)}}},[_vm._v(\"发送\")])])]):_vm._e(),_vm._v(\" \"),(_vm.loading)?[_c('loading')]:_vm._e()],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ var selectortype_template_index_0_src_chart = (esExports);\n// CONCATENATED MODULE: ./src/chart/index.vue\nfunction injectStyle (ssrContext) {\n  __webpack_require__(\"R/zc\")\n}\nvar normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-de02643e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  selectortype_script_index_0_src_chart,\n  selectortype_template_index_0_src_chart,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ var src_chart = __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/11.f930dafb63a0d35caacf.js","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"\\n.green[data-v-de02643e] {\\n  color: #03b349;\\n}\\n.doing-course[data-v-de02643e] {\\n  padding-bottom: 50px;\\n  margin-bottom: 10px;\\n}\\n.course-info[data-v-de02643e] {\\n  line-height: 2;\\n  margin: 10px 0;\\n  background: #fff;\\n  padding: 10px 20px;\\n}\\n.chart-box[data-v-de02643e] {\\n  height: calc(100% - 140px);\\n  overflow: hidden;\\n  line-height: 2;\\n  margin: 10px 0 0 0;\\n  padding: 10px 0 0 0;\\n}\\n.chart-list-scroll[data-v-de02643e] {\\n  padding: 0 20px;\\n  height: 100%;\\n  overflow: auto;\\n}\\n.chart-empty[data-v-de02643e] {\\n  color: #aaa;\\n  padding: 80px 0;\\n  text-align: center;\\n}\\n.msg-item[data-v-de02643e] {\\n  position: relative;\\n  margin-bottom: 14px;\\n}\\n.msg-item .user-icon[data-v-de02643e] {\\n    position: absolute;\\n    width: 30px;\\n    height: 30px;\\n    border: 2px solid #03b349;\\n    border-radius: 40px;\\n}\\n.msg-item .msg-time[data-v-de02643e] {\\n    line-height: 1.3;\\n    color: #aaa;\\n}\\n.msg-item .msg-text[data-v-de02643e] {\\n    min-height: 26px;\\n    display: inline-block;\\n    background: #fff;\\n    border: 1px solid #03b349;\\n    border-radius: 5px;\\n    padding: 0 20px;\\n    max-width: 100%;\\n    word-break: break-all;\\n    text-align: left;\\n}\\n.msg-item.msg-self .user-icon[data-v-de02643e] {\\n    right: 0;\\n}\\n.msg-item.msg-self .msg-content[data-v-de02643e] {\\n    padding-right: 50px;\\n    text-align: right;\\n}\\n.msg-item.msg-other .user-icon[data-v-de02643e] {\\n    left: 0;\\n}\\n.msg-item.msg-other .msg-content[data-v-de02643e] {\\n    padding-left: 50px;\\n}\\n.send-msg[data-v-de02643e] {\\n  position: fixed;\\n  bottom: 0;\\n  width: 100%;\\n  line-height: 2;\\n  background: #fbf9fe;\\n  padding: 0 0 6px 0;\\n}\\n.send-msg .send-box[data-v-de02643e] {\\n    border: 1px solid #eaeaea;\\n    border-width: 1px 0;\\n    background: #fff;\\n    height: 40px;\\n    position: relative;\\n}\\n.send-msg input[data-v-de02643e] {\\n    height: 40px;\\n    width: calc(100% - 80px);\\n    font-size: 16px;\\n    padding: 0 70px 0 10px;\\n    outline: 0;\\n    border: 0;\\n}\\n.send-msg .send-btn[data-v-de02643e] {\\n    background: #03b349;\\n    position: absolute;\\n    top: 0;\\n    right: 10px;\\n    color: #fff;\\n    padding: 0px 10px;\\n    margin: 8px 0;\\n    border-radius: 5px;\\n}\\n.send-msg .send-btn.btn-disabled[data-v-de02643e] {\\n      background: #eee;\\n      color: #aaa;\\n}\\n\", \"\", {\"version\":3,\"sources\":[\"D:/DATA/Vue/sdc-vue/src/chart/index.vue\"],\"names\":[],\"mappings\":\";AACA;EACE,eAAe;CAChB;AACD;EACE,qBAAqB;EACrB,oBAAoB;CACrB;AACD;EACE,eAAe;EACf,eAAe;EACf,iBAAiB;EACjB,mBAAmB;CACpB;AACD;EACE,2BAA2B;EAC3B,iBAAiB;EACjB,eAAe;EACf,mBAAmB;EACnB,oBAAoB;CACrB;AACD;EACE,gBAAgB;EAChB,aAAa;EACb,eAAe;CAChB;AACD;EACE,YAAY;EACZ,gBAAgB;EAChB,mBAAmB;CACpB;AACD;EACE,mBAAmB;EACnB,oBAAoB;CACrB;AACD;IACI,mBAAmB;IACnB,YAAY;IACZ,aAAa;IACb,0BAA0B;IAC1B,oBAAoB;CACvB;AACD;IACI,iBAAiB;IACjB,YAAY;CACf;AACD;IACI,iBAAiB;IACjB,sBAAsB;IACtB,iBAAiB;IACjB,0BAA0B;IAC1B,mBAAmB;IACnB,gBAAgB;IAChB,gBAAgB;IAChB,sBAAsB;IACtB,iBAAiB;CACpB;AACD;IACI,SAAS;CACZ;AACD;IACI,oBAAoB;IACpB,kBAAkB;CACrB;AACD;IACI,QAAQ;CACX;AACD;IACI,mBAAmB;CACtB;AACD;EACE,gBAAgB;EAChB,UAAU;EACV,YAAY;EACZ,eAAe;EACf,oBAAoB;EACpB,mBAAmB;CACpB;AACD;IACI,0BAA0B;IAC1B,oBAAoB;IACpB,iBAAiB;IACjB,aAAa;IACb,mBAAmB;CACtB;AACD;IACI,aAAa;IACb,yBAAyB;IACzB,gBAAgB;IAChB,uBAAuB;IACvB,WAAW;IACX,UAAU;CACb;AACD;IACI,oBAAoB;IACpB,mBAAmB;IACnB,OAAO;IACP,YAAY;IACZ,YAAY;IACZ,kBAAkB;IAClB,cAAc;IACd,mBAAmB;CACtB;AACD;MACM,iBAAiB;MACjB,YAAY;CACjB\",\"file\":\"index.vue\",\"sourcesContent\":[\"\\n.green[data-v-de02643e] {\\n  color: #03b349;\\n}\\n.doing-course[data-v-de02643e] {\\n  padding-bottom: 50px;\\n  margin-bottom: 10px;\\n}\\n.course-info[data-v-de02643e] {\\n  line-height: 2;\\n  margin: 10px 0;\\n  background: #fff;\\n  padding: 10px 20px;\\n}\\n.chart-box[data-v-de02643e] {\\n  height: calc(100% - 140px);\\n  overflow: hidden;\\n  line-height: 2;\\n  margin: 10px 0 0 0;\\n  padding: 10px 0 0 0;\\n}\\n.chart-list-scroll[data-v-de02643e] {\\n  padding: 0 20px;\\n  height: 100%;\\n  overflow: auto;\\n}\\n.chart-empty[data-v-de02643e] {\\n  color: #aaa;\\n  padding: 80px 0;\\n  text-align: center;\\n}\\n.msg-item[data-v-de02643e] {\\n  position: relative;\\n  margin-bottom: 14px;\\n}\\n.msg-item .user-icon[data-v-de02643e] {\\n    position: absolute;\\n    width: 30px;\\n    height: 30px;\\n    border: 2px solid #03b349;\\n    border-radius: 40px;\\n}\\n.msg-item .msg-time[data-v-de02643e] {\\n    line-height: 1.3;\\n    color: #aaa;\\n}\\n.msg-item .msg-text[data-v-de02643e] {\\n    min-height: 26px;\\n    display: inline-block;\\n    background: #fff;\\n    border: 1px solid #03b349;\\n    border-radius: 5px;\\n    padding: 0 20px;\\n    max-width: 100%;\\n    word-break: break-all;\\n    text-align: left;\\n}\\n.msg-item.msg-self .user-icon[data-v-de02643e] {\\n    right: 0;\\n}\\n.msg-item.msg-self .msg-content[data-v-de02643e] {\\n    padding-right: 50px;\\n    text-align: right;\\n}\\n.msg-item.msg-other .user-icon[data-v-de02643e] {\\n    left: 0;\\n}\\n.msg-item.msg-other .msg-content[data-v-de02643e] {\\n    padding-left: 50px;\\n}\\n.send-msg[data-v-de02643e] {\\n  position: fixed;\\n  bottom: 0;\\n  width: 100%;\\n  line-height: 2;\\n  background: #fbf9fe;\\n  padding: 0 0 6px 0;\\n}\\n.send-msg .send-box[data-v-de02643e] {\\n    border: 1px solid #eaeaea;\\n    border-width: 1px 0;\\n    background: #fff;\\n    height: 40px;\\n    position: relative;\\n}\\n.send-msg input[data-v-de02643e] {\\n    height: 40px;\\n    width: calc(100% - 80px);\\n    font-size: 16px;\\n    padding: 0 70px 0 10px;\\n    outline: 0;\\n    border: 0;\\n}\\n.send-msg .send-btn[data-v-de02643e] {\\n    background: #03b349;\\n    position: absolute;\\n    top: 0;\\n    right: 10px;\\n    color: #fff;\\n    padding: 0px 10px;\\n    margin: 8px 0;\\n    border-radius: 5px;\\n}\\n.send-msg .send-btn.btn-disabled[data-v-de02643e] {\\n      background: #eee;\\n      color: #aaa;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-de02643e\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/sass-loader/lib/loader.js?{\"sourceMap\":true}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/chart/index.vue\n// module id = LU1+\n// module chunks = 11","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/index.js?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-de02643e\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/sass-loader/lib/loader.js?{\\\"sourceMap\\\":true}!../../node_modules/vux-loader/src/style-loader.js!../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./index.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"f958979a\", content, true, {});\n\n\n// WEBPACK FOOTER //\n// \"}!./node_modules/vue-style-loader!./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-de02643e\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/sass-loader/lib/loader.js?{\"sourceMap\":true}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/chart/index.vue","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-de02643e\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vux-loader/src/style-loader.js!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-de02643e\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vux-loader/src/before-template-compiler-loader.js!../../node_modules/vux-loader/src/template-loader.js!../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-de02643e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/chart/index.vue\n// module id = null\n// module chunks = ","import { mapState } from 'vuex'\r\nimport request from '../utils/request'\r\nimport { errorMsg } from '../utils/common'\r\nexport default {\r\n  name: 'chartMixin',\r\n  data () {\r\n    return {\r\n      ws: null,\r\n      otherImg: '',\r\n      selfImg: '',\r\n      nowStuCode: '',\r\n      nowTeaCode: '',\r\n      stuIsInGroup: false,\r\n      teaIsInGroup: false\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      userType: state => state.user.userType,\r\n      openid: state => state.user.openid\r\n      // selfImg: state => state.user.infoObj.teaHeadimgurl || state.user.infoObj.stuHeadimgurl\r\n      // courseId: state => state.course.courseId\r\n    })\r\n  },\r\n  mounted () {\r\n    this.getOpenid()\r\n    // this.initWebsocket()\r\n  },\r\n  watch: {\r\n    courseId () {\r\n      this.getOpenid()\r\n      // this.initWebsocket()\r\n    }\r\n  },\r\n  methods: {\r\n    getOpenid () {\r\n      if (this.courseId === undefined || this.courseId === '') {\r\n        return\r\n      }\r\n      request({\r\n        url: 'course/getOnClassUserOpenid?courseId=' + this.courseId,\r\n        method: 'get',\r\n        data: {\r\n          artId: this.$route.params.id,\r\n          openid: this.$store.state.user.openid\r\n        }\r\n      }).then(res => {\r\n        if (res.data.code === 0) {\r\n          this.nowTeaCode = res.data.data.teaOpenid\r\n          this.nowStuCode = res.data.data.stuOpenid\r\n\r\n          request({\r\n            url: 'user/queryUserInfo?openid=' + this.nowTeaCode,\r\n            method: 'get'\r\n          }).then(res => {\r\n            // 获取自己头像\r\n            const type = (this.nowTeaCode === this.openid) ? 'self' : 'other'\r\n            if (Number(res.data.code) === 0) {\r\n              const obj = res.data.data\r\n              this[type + 'Img'] = obj.stuHeadimgurl || obj.teaHeadimgurl\r\n            }\r\n            // 获取对方头像\r\n            request({\r\n              url: 'user/queryUserInfo?openid=' + this.nowStuCode,\r\n              method: 'get'\r\n            }).then(res => {\r\n              const type = (this.nowTeaCode !== this.openid) ? 'self' : 'other'\r\n              // 获取之后才建立连接\r\n              this.initWebsocket()\r\n              if (Number(res.data.code) === 0) {\r\n                const obj = res.data.data\r\n                this[type + 'Img'] = obj.stuHeadimgurl || obj.teaHeadimgurl\r\n              }\r\n            })\r\n          })\r\n        }\r\n      })\r\n    },\r\n    initWebsocket () {\r\n      if (this.ws === null && this.courseId !== '') {\r\n        const url = 'ws://47.93.225.12:8082/socketServer/' + this.openid\r\n        this.ws = new WebSocket(url)\r\n\r\n        this.ws.onopen = this.websocketonopen\r\n        this.ws.onmessage = this.websocketonmessage\r\n        this.ws.onerror = this.websocketonerror\r\n        this.ws.onclose = this.websocketclose\r\n      }\r\n    },\r\n    websocketonopen () {\r\n      this.checkIsIn()\r\n    },\r\n    websocketonmessage (res) {\r\n      const resData = JSON.parse(res.data)\r\n      this.recSocketMsg(resData)\r\n    },\r\n    websocketonerror () {\r\n      this.initWebSocket()\r\n    },\r\n    websocketsend (req) {\r\n      this.ws.send(JSON.stringify(req))\r\n    },\r\n    websocketclose (e) {\r\n      console.log('断开连接', e)\r\n    },\r\n    checkIsIn () {\r\n      const req = {\r\n        groupname: this.courseId,\r\n        opttype: 'GetChatGroupUserList',\r\n        username: this.openid\r\n      }\r\n      this.websocketsend(req)\r\n    },\r\n    // 老师群组，如果老师不在就创建，并把学生加进来，在就获取历史记录\r\n    teaJoinGroup () {\r\n      const req = {\r\n        addusername: this.nowStuCode, // \"stuopenid\"\r\n        groupname: this.courseId, // \"courseid\"\r\n        opttype: 'CreateChatGroup',\r\n        username: this.openid // \"teaopenid\"\r\n      }\r\n      this.websocketsend(req)\r\n      this.loading = false\r\n    },\r\n    // 学生群组，如果不在就提示退出等，在就获取历史记录\r\n    // 获取聊天记录\r\n    getHis () {\r\n      const req = {\r\n        groupname: this.courseId, // \"courseid\"\r\n        opttype: 'GetChatGroupChatRecordList',\r\n        username: this.openid // \"stuopenid\"\r\n      }\r\n      this.websocketsend(req)\r\n    },\r\n    // socket发送消息\r\n    sendSocketMsg (msg) {\r\n      const req = {\r\n        content: msg,\r\n        groupname: this.courseId, // \"courseid\"\r\n        opttype: 'SendToChatGroup',\r\n        username: this.openid\r\n      }\r\n      this.websocketsend(req)\r\n    },\r\n    // socket接收消息\r\n    recSocketMsg (data) {\r\n      if (data.opttype === 'GetChatGroupUserList') {\r\n        // 判断是否在群里\r\n        if (data.errno !== 0) {\r\n          // 该用户不在群里\r\n          if (this.userType === 'teacher') {\r\n            this.teaJoinGroup()\r\n          } else {\r\n            errorMsg(this, '请退出,等待老师开课')\r\n          }\r\n        } else {\r\n          // 在群里，获取历史\r\n          this.loading = false\r\n          this.getHis()\r\n        }\r\n      } else if (data.opttype === 'GetChatGroupChatRecordList') {\r\n        this.loading = false\r\n        // 获取历史记录\r\n        if (data.errno === 0) {\r\n          this.renderHis(data.list)\r\n        } else {\r\n          errorMsg(this, data.errmsg)\r\n        }\r\n        this.$nextTick(() => {\r\n          this.loading = false\r\n        })\r\n      } else if (data.opttype === 'SendToChatGroup') {\r\n        // 渲染聊天消息\r\n        // if (data.errno === 0) {\r\n        this.renderChart(data)\r\n        // } else {\r\n        //   errorMsg(this, data.errmsg)\r\n        // }\r\n      }\r\n    },\r\n    renderHis (list) {\r\n      console.log('list', list)\r\n      list = list.sort((a, b) => {\r\n        return Number(a.inserttime) - Number(b.inserttime)\r\n      })\r\n      list.map(item => {\r\n        const tmp = JSON.parse(item.content)\r\n        tmp.time = new Date(item.inserttime)\r\n        this.renderChart(tmp)\r\n      })\r\n    },\r\n    renderChart (data) {\r\n      const type = (data.username === this.openid) ? 'self' : 'other'\r\n      console.log('re', this[type + 'Img'])\r\n      if (this[type + 'Img'] === '') {\r\n        new Promise((resolve) => {\r\n          this.getInfo(data.username, type, resolve)\r\n        }).then(() => {\r\n          this.sendMsgFn(type, data.content, data.time)\r\n        })\r\n      } else {\r\n        this.sendMsgFn(type, data.content, data.time)\r\n      }\r\n    },\r\n    getInfo (openid, type, resolve) {\r\n      if (type === 'self' && this['selfImg'] === '') {\r\n        this._getImg(openid, 'self', resolve)\r\n      }\r\n      if (type === 'other' && this['otherImg'] === '') {\r\n        this._getImg(openid, 'other', resolve)\r\n      }\r\n    },\r\n    _getImg (openid, type, resolve) {\r\n      request({\r\n        url: 'user/queryUserInfo?openid=' + openid,\r\n        method: 'get'\r\n      }).then(res => {\r\n        resolve()\r\n        if (Number(res.data.code) === 0) {\r\n          const obj = res.data.data\r\n          this[type + 'Img'] = obj.stuHeadimgurl || obj.teaHeadimgurl\r\n        }\r\n      }, 20)\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/chart/chartSocket.js","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport request from '../utils/request'\r\nimport chartSocket from './chartSocket.js'\r\nimport { msg, errorMsg } from '../utils/common'\r\nimport noData from '../components/noData'\r\nimport loading from '../components/loading'\r\n\r\nexport default {\r\n  name: 'chart',\r\n  components: { noData, loading },\r\n  mixins: [chartSocket],\r\n  data () {\r\n    return {\r\n      loading: true,\r\n      noCourse: false,\r\n      courseName: '',\r\n      teaName: '',\r\n      courseTime: '',\r\n      chartList: [],\r\n      sendMsg: '',\r\n      courseId: '',\r\n      doingList: [],\r\n      count: 0,\r\n      isEnd: false\r\n    }\r\n  },\r\n  computed: {\r\n    btnDisabled () {\r\n      return this.sendMsg === ''\r\n    },\r\n    teaOpenid () {\r\n      return this.$store.state.user.infoObj.teaOpenid || ''\r\n    },\r\n    stuOpenid () {\r\n      return this.$store.state.user.infoObj.stuOpenid || ''\r\n    },\r\n    userType () {\r\n      return this.$store.state.user.userType\r\n    }\r\n  },\r\n  mounted () {\r\n    this.$store.commit('SET_RETURN_TEXT', '在线交流')\r\n    this.$store.commit('SET_RETURN_URL', '/my')\r\n    this.getDoingList()\r\n  },\r\n  watch: {\r\n    userType () {\r\n      this.getDoingList()\r\n    }\r\n  },\r\n  methods: {\r\n    getCourseCount () {\r\n      request({\r\n        url: 'course/getCountDown?courseId=' + this.courseId,\r\n        method: 'get'\r\n      }).then(res => {\r\n        if (res.data.code === 0) {\r\n          if (res.data.data === 'end') {\r\n            this.showEnd()\r\n          } else {\r\n            this.count = Number(res.data.data)\r\n            this.startCount()\r\n          }\r\n        }\r\n      })\r\n    },\r\n    checkEnd () {\r\n      request({\r\n        url: 'course/onCourseEnd?courseId=' + this.courseId,\r\n        method: 'get'\r\n      }).then(res => {\r\n        if (res.data.code === 0) {\r\n          res.data.data = true\r\n          this.isEnd = res.data.data\r\n          if (!res.data.data) {\r\n            this.startCount()\r\n          } else {\r\n            this.showEnd()\r\n          }\r\n        }\r\n      })\r\n    },\r\n    startCount () {\r\n      setTimeout(() => {\r\n        this.checkEnd()\r\n      }, this.count * 1000)\r\n    },\r\n    showEnd () {\r\n      this.isEnd = true\r\n      msg(this, '课程已结束')\r\n    },\r\n    clickSend () {\r\n      if (this.isEnd) {\r\n        return\r\n      }\r\n      this.sendSocketMsg(this.sendMsg)\r\n      this.sendMsgFn('self', this.sendMsg)\r\n    },\r\n    sendMsgFn (type, msg, time) {\r\n      // console.log('dd', type, msg)\r\n      if (msg === '') {\r\n        return\r\n      }\r\n      let msgTime = time || new Date()\r\n      msgTime = msgTime.toTimeString().split(' ')[0]\r\n      this.chartList.push({\r\n        time: msgTime,\r\n        role: type,\r\n        text: msg\r\n      })\r\n      this.$nextTick(() => {\r\n        document.querySelector('.chart-list-scroll').scrollTop = 999999\r\n      })\r\n      if (type === 'self') {\r\n        this.sendMsg = ''\r\n      }\r\n    },\r\n    getTime (str) {\r\n      const hour = str.split(' ')[1].split(':')[0]\r\n      const min = str.split(' ')[1].split(':')[1]\r\n      return hour + ':' + min\r\n    },\r\n    getDoingList () {\r\n      this.loading = true\r\n      let url = ''\r\n      if (this.userType === 'teacher') {\r\n        url = 'tea/findTeaHistoryCourse'\r\n        url += '?teaOpenid=' + this.teaOpenid + '&page=1&pageSize=1000'\r\n      } else if (this.userType === 'student') {\r\n        url = 'stu/lookHistory'\r\n        url += '?stuOpenid=' + this.stuOpenid + '&page=1&pageSize=1000'\r\n      }\r\n      request({\r\n        url: url,\r\n        method: 'get'\r\n      }).then(res => {\r\n        this.loading = false\r\n\r\n        if (res.data.code === 0 && res.data.data !== undefined) {\r\n          this.doingList = res.data.data.filter(item => {\r\n            if (this.userType === 'teacher') {\r\n              return item.teaCourse.courseStatus === 302\r\n            } else {\r\n              return item.teaCourse.courseStatus === 302 && item.subStatus === 401\r\n            }\r\n          }).map(item => {\r\n            item.teaCourse.courseTime = item.teaCourse.courseDate.split(' ')[0] + ' ' + this.getTime(item.teaCourse.courseStartTime) + ' - ' + this.getTime(item.teaCourse.courseEndTime)\r\n            return item\r\n          })\r\n          if (this.doingList.length === 0) {\r\n            this.noCourse = true\r\n            errorMsg(this, '请退出等待开课')\r\n          } else {\r\n            this.courseId = this.doingList[0].teaCourse.courseId\r\n            this.courseName = this.doingList[0].teaCourse.courseName\r\n            this.courseTime = this.doingList[0].teaCourse.courseTime\r\n            if (this.userType === 'student') {\r\n              this.teaName = this.doingList[0].teaName\r\n            } else {\r\n              this.teaName = this.doingList[0].teaBase.teaName\r\n            }\r\n            this.noCourse = false\r\n            this.getCourseCount()\r\n          }\r\n        } else {\r\n          this.noCourse = true\r\n          errorMsg(this, '请退出等待开课')\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/chart/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"doing-course\"},[(!_vm.loading && _vm.noCourse)?_c('div',{staticClass:\"no-course\"},[_c('no-data',{attrs:{\"text\":'当前没有正在上的课'}})],1):_vm._e(),_vm._v(\" \"),(!_vm.loading && !_vm.noCourse)?_c('div',{staticClass:\"course-info\"},[_c('div',{staticClass:\"course-name\"},[_c('label',[_vm._v(\"课程名称：\")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.courseName))])]),_vm._v(\" \"),_c('div',{staticClass:\"course-time\"},[_c('label',[_vm._v(\"课程时间：\")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.courseTime))])]),_vm._v(\" \"),_c('div',{staticClass:\"course-time\"},[_c('label',[_vm._v(\"老师姓名：\")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(_vm.teaName))])])]):_vm._e(),_vm._v(\" \"),(!_vm.loading && !_vm.noCourse)?_c('div',{staticClass:\"chart-box\"},[_c('div',{staticClass:\"chart-list-scroll\"},[_vm._l((_vm.chartList),function(item){return (_vm.chartList.length !== 0)?_c('div',{staticClass:\"chart-list\"},[(item.role === 'self')?_c('div',{staticClass:\"msg-self msg-item\"},[_c('img',{staticClass:\"user-icon\",attrs:{\"src\":_vm.selfImg}}),_vm._v(\" \"),_c('div',{staticClass:\"msg-content\"},[_c('div',{staticClass:\"msg-text\"},[_vm._v(_vm._s(item.text))]),_vm._v(\" \"),_c('div',{staticClass:\"msg-time\"},[_vm._v(_vm._s(item.time))])])]):_vm._e(),_vm._v(\" \"),(item.role === 'other')?_c('div',{staticClass:\"msg-other msg-item\"},[_c('img',{staticClass:\"user-icon\",attrs:{\"src\":_vm.otherImg}}),_vm._v(\" \"),_c('div',{staticClass:\"msg-content\"},[_c('div',{staticClass:\"msg-text\"},[_vm._v(_vm._s(item.text))]),_vm._v(\" \"),_c('div',{staticClass:\"msg-time\"},[_vm._v(_vm._s(item.time))])])]):_vm._e()]):_vm._e()}),_vm._v(\" \"),(_vm.chartList.length === 0)?_c('div',{staticClass:\"chart-list chart-empty\"},[_vm._v(\"\\n        暂无聊天记录\\n      \")]):_vm._e()],2)]):_vm._e(),_vm._v(\" \"),(!_vm.loading && !_vm.noCourse)?_c('div',{staticClass:\"send-msg\"},[_c('div',{staticClass:\"send-box\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.sendMsg),expression:\"sendMsg\"}],attrs:{\"type\":\"text\",\"disabled\":_vm.isEnd},domProps:{\"value\":(_vm.sendMsg)},on:{\"keyup\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.clickSend($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.sendMsg=$event.target.value}}}),_vm._v(\" \"),_c('div',{staticClass:\"send-btn\",class:{'btn-disabled': _vm.isEnd || _vm.btnDisabled},on:{\"click\":function($event){$event.stopPropagation();return _vm.clickSend($event)}}},[_vm._v(\"发送\")])])]):_vm._e(),_vm._v(\" \"),(_vm.loading)?[_c('loading')]:_vm._e()],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-de02643e\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vux-loader/src/before-template-compiler-loader.js!./node_modules/vux-loader/src/template-loader.js!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/chart/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}